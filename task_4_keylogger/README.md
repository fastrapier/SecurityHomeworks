# Task 4: Keylogger Demo - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

–£—á–µ–±–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ç–µ—Ö–Ω–∏–∫–∏ **Input Capture: Keylogging** (MITRE ATT&CK T1056.001).

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –¢–æ–ª—å–∫–æ –¥–ª—è —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª–µ–π!

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω **–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ** –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ç–µ—Ö–Ω–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. 

**–ó–ê–ü–†–ï–©–ï–ù–û:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —á—É–∂–∏—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö –±–µ–∑ —è–≤–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è
- –ü—Ä–∏–º–µ–Ω—è—Ç—å –¥–ª—è –∫—Ä–∞–∂–∏ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —à–ø–∏–æ–Ω–∞–∂–∞
- –û–±—Ö–æ–¥–∏—Ç—å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—É—é –∑–∞—â–∏—Ç—É
- –°–∫—Ä—ã–≤–∞—Ç—å —Ñ–∞–∫—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–ê–ó–†–ï–®–ï–ù–û:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- –ò–∑—É—á–∞—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã –∫–µ–π–ª–æ–≥–≥–µ—Ä–æ–≤
- –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö —Å —Å–æ–≥–ª–∞—Å–∏—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ Python, –∫–æ—Ç–æ—Ä—ã–π:

1. **–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —è–≤–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã
2. **–ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à** —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. **–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–∏–º–≤–æ–ª—ã** –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è** –ø–æ—Å–ª–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–∞–∂–∞—Ç–∏–π
5. **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –≤ –ø–æ–Ω—è—Ç–Ω–æ–º –≤–∏–¥–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:

- ‚úÖ –Ø–≤–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ –∑–∞–ø—Ä–æ—Å —Å–æ–≥–ª–∞—Å–∏—è
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π, –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã
- ‚úÖ –ë–µ–∑ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –∏ —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows, Linux –∏ macOS

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
make install
```

–∏–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
pip install -r requirements.txt
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã

```bash
make run
```

–∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:

```bash
python keylogger.py
```

### –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ (CI —Ä–µ–∂–∏–º)

```bash
make test
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
task_4_keylogger/
‚îú‚îÄ‚îÄ keylogger.py           # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (pynput)
‚îú‚îÄ‚îÄ Makefile              # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞
‚îî‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ `keylogger.py` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```python
# –ü—É—Ç—å –∫ –ª–æ–≥-—Ñ–∞–π–ª—É
LOG_FILE = r"C:\temp\keydemo.log"  # Windows
# –∏–ª–∏
LOG_FILE = "/tmp/keydemo.log"      # Linux/macOS

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
MAX_DURATION_SECONDS = 30  # –ú–∞–∫—Å–∏–º—É–º 30 —Å–µ–∫—É–Ω–¥ —Ä–∞–±–æ—Ç—ã
MAX_KEY_PRESSES = 100      # –ò–ª–∏ –º–∞–∫—Å–∏–º—É–º 100 –Ω–∞–∂–∞—Ç–∏–π
```

---

## üìù –§–æ—Ä–º–∞—Ç –ª–æ–≥-—Ñ–∞–π–ª–∞

–õ–æ–≥-—Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è:

```
======================================================================
KEYLOGGER LOG - 2025-12-20 15:30:45
======================================================================
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: 30—Å –∏–ª–∏ 100 –Ω–∞–∂–∞—Ç–∏–π
======================================================================

[2025-12-20 15:30:47.123] Key: 'h'
[2025-12-20 15:30:47.234] Key: 'e'
[2025-12-20 15:30:47.345] Key: 'l'
[2025-12-20 15:30:47.456] Key: 'l'
[2025-12-20 15:30:47.567] Key: 'o'
[2025-12-20 15:30:47.678] Special: space
[2025-12-20 15:30:47.789] Key: 'w'
[2025-12-20 15:30:47.890] Key: 'o'
[2025-12-20 15:30:47.991] Key: 'r'
[2025-12-20 15:30:48.102] Key: 'l'
[2025-12-20 15:30:48.213] Key: 'd'
[2025-12-20 15:30:48.324] Special: enter
=== –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ===
```

---

## üîß –ö–æ–º–∞–Ω–¥—ã Makefile

```bash
make install   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
make run       # –ó–∞–ø—É—Å—Ç–∏—Ç—å keylogger
make test      # –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ (CI —Ä–µ–∂–∏–º, 10 —Å–µ–∫—É–Ω–¥)
make clean     # –£–¥–∞–ª–∏—Ç—å –ª–æ–≥-—Ñ–∞–π–ª
make help      # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã
```

---

## üêç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

- **pynput** - –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ –º—ã—à–∏
  - –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
  - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows, Linux, macOS
  - –ü—Ä–æ—Å—Ç–æ–π API

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥-—Ñ–∞–π–ª–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
2. **–°–ª—É—à–∞—Ç–µ–ª—å**: `pynput.keyboard.Listener` —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–æ–±—ã—Ç–∏–π
3. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫**: –§—É–Ω–∫—Ü–∏—è `on_key_press()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–∞–∂–∞—Ç–∏–∏
4. **–ó–∞–ø–∏—Å—å**: –°–∏–º–≤–æ–ª—ã –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π
5. **–û—Å—Ç–∞–Ω–æ–≤–∫–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ —Ç–∞–π–º–µ—Ä—É/—Å—á–µ—Ç—á–∏–∫—É –∏–ª–∏ –ø–æ Ctrl+C

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–°–∫—Ä–∏–ø—Ç **–ù–ï**:
- ‚ùå –ù–µ —Å–∫—Ä—ã–≤–∞–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É
- ‚ùå –ù–µ —à–∏—Ñ—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ
- ‚ùå –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Å–µ—Ç—å
- ‚ùå –ù–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É
- ‚ùå –ù–µ –æ–±—Ö–æ–¥–∏—Ç –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã

---

## üéì MITRE ATT&CK T1056.001

**–¢–µ—Ö–Ω–∏–∫–∞**: Input Capture: Keylogging

**–¢–∞–∫—Ç–∏–∫–∞**: Collection, Credential Access

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–µ–π–ª–æ–≥–≥–µ—Ä—ã –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å:
- –ü–∞—Ä–æ–ª–∏ –∏ –ª–æ–≥–∏–Ω—ã
- –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–ø–∏—Å–∫—É
- –§–∏–Ω–∞–Ω—Å–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ —Å–µ–∫—Ä–µ—Ç—ã

**–ó–∞—â–∏—Ç–∞**:
1. **–ê–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω–æ–µ –ü–û** - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–µ–π–ª–æ–≥–≥–µ—Ä–æ–≤
2. **HIDS/HIPS** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
3. **–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞** - –¥–ª—è –≤–≤–æ–¥–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ø–∞—Ä–æ–ª–∏)
4. **2FA/MFA** - –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞—â–∏—â–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –∫—Ä–∞–∂–µ –ø–∞—Ä–æ–ª—è
5. **–ê–Ω—Ç–∏–∫–µ–π–ª–æ–≥–≥–µ—Ä—ã** - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ü–û –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –≤–≤–æ–¥–∞

**–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ (IoC)**:
- –ü—Ä–æ—Ü–µ—Å—Å—ã —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ API –≤—ã–∑–æ–≤–∞–º–∏ (`GetAsyncKeyState`, `SetWindowsHookEx`)
- –ù–µ–æ–±—ã—á–Ω–∞—è —Å–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Ç –æ–±—ã—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU/RAM –æ—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –§–∞–π–ª—ã —Å –ª–æ–≥–∞–º–∏ –≤ –Ω–µ–æ–±—ã—á–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

---

## üß™ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### GitHub Actions

–°–∫—Ä–∏–ø—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –æ–±—â–∏–π workflow –ø—Ä–æ–µ–∫—Ç–∞ (`.github/workflows/security-tasks.yml`).

**Job `task-4-keylogger`**:
1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Python 3.11
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`pynput`)
3. –ó–∞–ø—É—Å–∫–∞–µ—Ç keylogger –≤ CI —Ä–µ–∂–∏–º–µ (–±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–≥–ª–∞—Å–∏—è)
4. –ñ–¥–µ—Ç 10 —Å–µ–∫—É–Ω–¥
5. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥-—Ñ–∞–π–ª–∞
6. –í—ã–≤–æ–¥–∏—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ job-–ª–æ–≥
7. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª–æ–≥-—Ñ–∞–π–ª –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç

**–ó–∞–ø—É—Å–∫**:
```bash
# –ß–µ—Ä–µ–∑ GitHub UI: Actions ‚Üí Security Tasks CI ‚Üí Run workflow
# –í—ã–±—Ä–∞—Ç—å "–ó–∞–ø—É—Å—Ç–∏—Ç—å Task 4 (Keylogger Demo)"
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í headless –æ–∫—Ä—É–∂–µ–Ω–∏–∏ (Linux CI –±–µ–∑ X11) keylogger –º–æ–∂–µ—Ç –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –Ω–∞–∂–∞—Ç–∏—è, –Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–∑–¥–∞—Å—Ç –ª–æ–≥-—Ñ–∞–π–ª –∏ –ø–æ–∫–∞–∂–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫–æ–¥–∞.

---

## üìö –£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã?

**Windows:**
- `SetWindowsHookEx` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–∞ –¥–ª—è WH_KEYBOARD_LL
- `GetAsyncKeyState` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–∞–≤–∏—à
- Raw Input API - –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º –≤–≤–æ–¥–∞

**Linux:**
- `/dev/input/eventX` - —á—Ç–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–≤–æ–¥–∞
- X11 XGrabKey - –ø–µ—Ä–µ—Ö–≤–∞—Ç –≤ X Window System
- libevdev - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å evdev

**macOS:**
- CGEventTap - –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–æ–±—ã—Ç–∏–π Core Graphics
- IOKit - –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –¥–æ—Å—Ç—É–ø –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º

**pynput** –∞–±—Å—Ç—Ä–∞–≥–∏—Ä—É–µ—Ç —ç—Ç–∏ —Ä–∞–∑–ª–∏—á–∏—è –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π API.

### –õ–µ–≥–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–µ–π–ª–æ–≥–≥–µ—Ä–æ–≤

1. **–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–π
2. **–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–µ–π—Å—Ç–≤–∏–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º)
3. **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ UX** - –∞–Ω–∞–ª–∏–∑ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
5. **–û–±—É—á–µ–Ω–∏–µ —Å–ª–µ–ø–æ–π –ø–µ—á–∞—Ç–∏** - –∞–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏

**–í–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö —Ç—Ä–µ–±—É–µ—Ç—Å—è —è–≤–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!**

---

## üõ°Ô∏è –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å** —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –±–∞–∑–∞–º–∏
2. **–í–∫–ª—é—á–∏—Ç–µ 2FA** –≤–µ–∑–¥–µ, –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
3. **–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞** –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã** –≤ Task Manager / Activity Monitor
5. **–ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ** –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

1. **–ò–∑–±–µ–≥–∞–π—Ç–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π** –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π –≤–≤–æ–¥** (password fields)
3. **–û—á–∏—â–∞–π—Ç–µ –±—É—Ñ–µ—Ä—ã** –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö API** –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ö—É–∫–æ–≤

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–µ–π–ª–æ–≥–≥–µ—Ä–æ–≤

```powershell
# Windows: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
Get-Process | Where-Object {$_.MainWindowTitle -eq ""}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏
Get-ItemProperty HKCU:\Software\Microsoft\Windows\CurrentVersion\Run
```

```bash
# Linux: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ /dev/input
lsof /dev/input/event*

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
ps aux | grep -E 'python|keylog'
```

---

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [MITRE ATT&CK T1056.001](https://attack.mitre.org/techniques/T1056/001/)
- [pynput Documentation](https://pynput.readthedocs.io/)
- [Windows Keyboard Input](https://docs.microsoft.com/en-us/windows/win32/inputdev/keyboard-input)
- [OWASP Input Validation](https://owasp.org/www-project-proactive-controls/v3/en/c5-validate-inputs)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –∫—É—Ä—Å–∞ –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ò–¢–ò–° 2025.

**–ê–≤—Ç–æ—Ä**: –°—Ç—É–¥–µ–Ω–∏–∫–∏–Ω –î–∞–Ω–∏–∏–ª, –≥—Ä—É–ø–ø–∞ 11-312

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –¢–æ–ª—å–∫–æ –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –†–§.

---

## ‚ùì FAQ

**Q: –ü–æ—á–µ–º—É keylogger –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ macOS –±–µ–∑ sudo?**  
A: macOS —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–æ–±—ã—Ç–∏—è–º –≤–≤–æ–¥–∞. –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Terminal/IDE –≤ System Preferences ‚Üí Security & Privacy ‚Üí Privacy ‚Üí Input Monitoring.

**Q: –ê–Ω—Ç–∏–≤–∏—Ä—É—Å —É–¥–∞–ª—è–µ—Ç —Å–∫—Ä–∏–ø—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å?**  
A: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ. –î–æ–±–∞–≤—å—Ç–µ –ø–∞–ø–∫—É –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –≤–≤–æ–¥ –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö?**  
A: –î–∞, pynput –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –Ω–∞–∂–∞—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã. –ù–æ —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∑–∞—â–∏—Ç–Ω—ã–º –ü–û.

**Q: –õ–µ–≥–∞–ª–µ–Ω –ª–∏ —ç—Ç–æ—Ç –∫–æ–¥?**  
A: –°–∞–º –∫–æ–¥ –ª–µ–≥–∞–ª–µ–Ω. –ù–µ–∑–∞–∫–æ–Ω–Ω–æ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–µ–∑ —Å–æ–≥–ª–∞—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –¥–ª—è –∫—Ä–∞–∂–∏ –¥–∞–Ω–Ω—ã—Ö. –í—Å–µ–≥–¥–∞ —Å–æ–±–ª—é–¥–∞–π—Ç–µ –∑–∞–∫–æ–Ω—ã –†–§ –æ –∑–∞—â–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (152-–§–ó).

**Q: –ü–æ—á–µ–º—É –≤ CI –Ω–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –∫–ª–∞–≤–∏—à?**  
A: GitHub Actions runners —Ä–∞–±–æ—Ç–∞—é—Ç –≤ headless —Ä–µ–∂–∏–º–µ –±–µ–∑ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Å—Ä–µ–¥—ã. Keylogger –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ —Å–æ–∑–¥–∞–µ—Ç –ª–æ–≥, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π –Ω–µ—Ç. –ù–∞ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Å GUI –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç.

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

- [Task 1: –ë—Ä—É—Ç—Ñ–æ—Ä—Å 7z –∞—Ä—Ö–∏–≤–∞](../task_1_brutforce/)
- [Task 2: –ë—Ä—É—Ç—Ñ–æ—Ä—Å SSH —Å Medusa](../task_2_medusa/)
- [Task 3: Windows Killer (File Masquerading)](../task_3_windows_killer/)

