# Task 3: Windows Killer - File Masquerading

Демонстрация техники маскировки вредоносных файлов (File Masquerading) согласно MITRE ATT&CK T1036.

## Описание

Этот проект демонстрирует, как вредоносное ПО маскируется под легитимные файлы для обхода защиты:

- **Двойные расширения**: `document.pdf.exe`, `report.txt.exe` - выглядят как документы
- **Системные имена**: `svchost.exe`, `pythonw.exe`, `WindowsUpdate.exe` - похожи на системные процессы
- **Поддельные директории**: размещение в `/fake_system32/`, `/fake_program_files/`

После маскировки скрипт находит и удаляет тестовую папку `/test_windows32` с имитацией системных файлов.

## MITRE ATT&CK

**Техника:** T1036 - Masquerading  
**Описание:** Злоумышленники манипулируют именами и расположением файлов, чтобы замаскировать вредоносное ПО под легитимные файлы или процессы.

**Методы:**
- Переименование под системные процессы
- Использование двойных расширений
- Размещение в доверенных директориях

**Ссылка:** https://attack.mitre.org/techniques/T1036/

## Быстрый запуск

```bash
make
```

## Команды

```bash
make build    # Собрать Docker образ
make run      # Запустить демонстрацию
make all      # Собрать и запустить
make clean    # Удалить контейнеры и образ
```

## Что происходит внутри

1. **Этап 1:** Создание тестовой среды
   - Создается папка `/test_windows32` с тестовыми системными файлами
   - Имитация структуры Windows System32

2. **Этап 2:** Маскировка файлов
   - Создание копий скрипта с двойными расширениями (`.pdf.exe`, `.txt.exe`, `.docx.exe`)
   - Маскировка под системные процессы (`svchost.exe`, `pythonw.exe`, `WindowsUpdate.exe`)
   - Размещение в поддельных системных директориях

3. **Этап 3:** Поиск и удаление
   - Обнаружение целевой директории `/test_windows32`
   - Подсчет и вывод списка файлов
   - Удаление файлов и директории
   - Подтверждение успешного удаления

## Логирование

Скрипт выводит простые логи без эмодзи в формате:

```
[2025-12-20 10:15:30] Создана тестовая папка: /test_windows32
[2025-12-20 10:15:31] Создано замаскированных файлов: 7
[2025-12-20 10:15:32] ОБНАРУЖЕНА целевая директория: /test_windows32
[2025-12-20 10:15:33] Удален: kernel32.dll
[2025-12-20 10:15:34] Подтверждение: целевая директория больше не существует
```

## Безопасность

**ВНИМАНИЕ:** Этот проект создан исключительно в образовательных целях для демонстрации техник кибербезопасности.

- Работает только в изолированном Docker-контейнере
- Удаляет только тестовую папку `/test_windows32`
- Не воздействует на реальную систему
- Не содержит реального вредоносного кода

## Ручной запуск

```bash
docker build -t windows-killer .
docker run -it windows-killer

# Или с интерактивным bash
docker run -it windows-killer /bin/bash
python3 /task/killer.py
```

## Требования

- Docker
- Make (опционально, для удобства)

## Примеры маскировки

### Двойные расширения
- `document.pdf.exe` - выглядит как PDF, но это исполняемый файл
- `report.txt.exe` - выглядит как TXT, но это исполняемый файл
- `data.docx.exe` - выглядит как Word документ, но это исполняемый файл

### Системные имена
- `svchost.exe` - легитимный системный процесс Windows
- `pythonw.exe` - легитимный процесс Python
- `WindowsUpdate.exe` - похоже на обновление Windows
- `update.exe` - общее имя процесса обновления

### Доверенные директории
- `/fake_system32/` - имитация C:\Windows\System32
- `/fake_program_files/` - имитация C:\Program Files
- `/fake_windows/` - имитация C:\Windows

## Защита от маскировки

Для защиты от техники File Masquerading:

1. Проверяйте цифровые подписи исполняемых файлов
2. Включите отображение расширений файлов в проводнике
3. Используйте антивирусы с эвристическим анализом
4. Блокируйте выполнение файлов из недоверенных директорий
5. Мониторьте системные процессы на аномальную активность

